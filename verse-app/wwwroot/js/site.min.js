function GetVerse(){var n=Phil[Math.round(Math.random()*(Phil.length-1))];Status===3&&(n=Refs[Math.round(Math.random()*(Refs.length-1))]);$.ajax({url:"https://api.esv.org/v3/passage/html/?q=Philippians"+n+"&include-verse-anchors=false&include-chapter-numbers=false&include-first-verse-numbers=false&include-footnotes=false&include-headings=false&include-subheadings=false&include-audio-link=false",type:"GET",headers:{Authorization:"Token 00706264fcd4c12e299878dbdf3af0608adbabff"},success:function(n){$("#Verse").html(n.passages)}})}function SubmitVerse(){var r=$("#Typed").val().replace(/[^A-Za-z]/gi,""),n=$("#Verse").find("p:first").text().replace(/[^A-Za-z]/gi,"");console.log(r,n);var t=calculateLevDistance("",n),u=calculateLevDistance(r,n),i=Math.round((1-u/t)*100),f=Math.round(i*i*t/1e3);console.log(u,t);Score+=f;$("#Score").text("Score: "+Score);$("#History > tbody").prepend("<tr><td>"+f+"<\/td > <td>"+i+"%<\/td> <td>"+$("#Typed").val()+"<\/td><\/tr > ")}function TimeTick(){Time-=1;Time===0?(SubmitVerse(),$("#Typed").blur(),clearInterval(Timer),Status=4,$("#FinalScore").text("Score: "+Score),$("#EndPage").show()):Time%60<10?$("#Time").text("Time: "+Math.floor(Time/60)+":0"+Time%60):$("#Time").text("Time: "+Math.floor(Time/60)+":"+Time%60)}function calculateLevDistance(n,t){var s,e=n.length,f=t.length,h,c,r=[],o,i,u;for(r[0]=[],e<f&&(h=n,n=t,t=h,c=e,e=f,f=c),o=0;o<f+1;o++)r[0][o]=o;for(i=1;i<e+1;i++)for(r[i]=[],r[i][0]=i,u=1;u<f+1;u++)s=n.charAt(i-1)===t.charAt(u-1)?0:1,r[i][u]=Math.min(r[i-1][u]+1,r[i][u-1]+1,r[i-1][u-1]+s);return r[e][f]}var Timer=null,Time=120,Score=0,Status=1,Phil=["1:6","2:1","2:5","2:6","2:12","3:20","4:4","4:6-7","4:8","4:13","4:19"],ChVs=[30,30,21,23],Refs=[];$(document).ready(function(){var n,t;for($("#EndPage").hide(),n=0;n<ChVs.length;n++)for(t=0;t<ChVs[n];t++)Refs.push(n+1+":"+t+1)});$("#Start").click(function(){$("#StartPage").hide();Status=2;GetVerse();$("#Typed").focus();setTimeout(Timer=setInterval(TimeTick,1e3),1e3)});$(document).keypress(function(n){n.keyCode===13&&Status===1?$("#Start").click():n.keyCode===13&&Status===4&&$("#Restart").click()});$("#Restart").click(function(){$("#EndPage").hide();Status=2;Score=0;GetVerse();$("#Typed").focus();setTimeout(Timer=setInterval(TimeTick,1e3),1e3)});$("#Submit").click(function(){Status=Status===2?3:2;SubmitVerse();GetVerse();$("#Typed").val("")});$("#Typed").on("keypress",function(n){n.keyCode===13&&$("#Typed").val().length>5&&$("#Submit").click()});