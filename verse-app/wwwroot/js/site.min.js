function GetVerse(n){$.ajax({url:"https://api.esv.org/v3/passage/html/?q="+n+"&include-verse-anchors=false&include-chapter-numbers=false&include-first-verse-numbers=false&include-footnotes=false&include-headings=false&include-subheadings=false&include-audio-link=false",type:"GET",headers:{Authorization:"Token 00706264fcd4c12e299878dbdf3af0608adbabff"},success:function(n){$("#Verse").html(n.passages)}})}function SubmitVerse(){var u=$("#Typed").val().replace(/\W/g,""),i=$(".woc").text().replace(/\W/g,""),t=calculateLevDistance("",i),r=calculateLevDistance(u,i),f=Math.round((1-r/t)*t*10/(LastTime-Time));Score+=f;$("#Score").text("Score: "+Score);var n=$("#History").insertRow(0),o=n.insertCell(0),e=n.insertCell(1),s=n.insertCell(2),h=n.insertCell(3);e.innerHTML=(1-r/t).toFixed(2);LastTime=Time;GetVerse()}function TimeTick(){Time-=1;Time===0?(clearInterval(Timer),$("#FinalScore").text("Score: "+Score),$("#EndPage").show()):Time%60<10?$("#Time").text("Time: "+Math.floor(Time/60)+":0"+Time%60):$("#Time").text("Time: "+Math.floor(Time/60)+":"+Time%60)}function calculateLevDistance(n,t){var s,e=n.length,f=t.length,h,c,r=[],o,i,u;for(r[0]=[],e<f&&(h=n,n=t,t=h,c=e,e=f,f=c),o=0;o<f+1;o++)r[0][o]=o;for(i=1;i<e+1;i++)for(r[i]=[],r[i][0]=i,u=1;u<f+1;u++)s=n.charAt(i-1)===t.charAt(u-1)?0:1,r[i][u]=Math.min(r[i-1][u]+1,r[i][u-1]+1,r[i-1][u-1]+s);return r[e][f]}var Timer=null,Time=120,LastTime=120,Score=0,Verse;$(document).ready(function(){$("#EndPage").hide()});$("#Start").click(function(){$("#StartPage").hide();GetVerse("jn3:16");$("#Typed").focus();setTimeout(Timer=setInterval(TimeTick,1e3),1e3)});$("#Submit").click(function(){SubmitVerse()});$("#Typed").on("keypress",function(n){n.keyCode===13&&SubmitVerse()});