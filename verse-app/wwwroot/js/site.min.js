function GetPassage(n){$.ajax({url:"https://api.esv.org/v3/passage/html/?q="+n+"&include-verse-anchors=false&include-chapter-numbers=false&include-first-verse-numbers=false&include-footnotes=false&include-headings=false&include-subheadings=false&include-audio-link=false",type:"GET",headers:{Authorization:"Token 00706264fcd4c12e299878dbdf3af0608adbabff"},success:function(n){$("#Passage").html(n.passages);$("#TextBox").focus();setTimeout(Timer=setInterval(TimeTick,1e3),500)}})}function TimeTick(){Time+=1;Time%60<10?$("#Time").text("Time: "+Math.floor(Time/60)+":0"+Time%60):$("#Time").text("Time: "+Math.floor(Time/60)+":"+Time%60)}function SubmitVerse(){var r=$("#Typed").val().replace(/[^A-Za-z]/gi,""),n=$("#Verse").find("p:first").text().replace(/[^A-Za-z]/gi,"");console.log(r,n);var t=calculateLevDistance("",n),u=calculateLevDistance(r,n),i=Math.round((1-u/t)*100),f=Math.round(i*i*t/1e3);console.log(u,t);Score+=f;$("#Score").text("Score: "+Score);$("#History > tbody").prepend("<tr><td>"+f+"<\/td > <td>"+i+"%<\/td> <td>"+$("#Typed").val()+"<\/td><\/tr > ")}function calculateLevDistance(n,t){var s,e=n.length,f=t.length,h,c,r=[],o,i,u;for(r[0]=[],e<f&&(h=n,n=t,t=h,c=e,e=f,f=c),o=0;o<f+1;o++)r[0][o]=o;for(i=1;i<e+1;i++)for(r[i]=[],r[i][0]=i,u=1;u<f+1;u++)s=n.charAt(i-1)===t.charAt(u-1)?0:1,r[i][u]=Math.min(r[i-1][u]+1,r[i][u-1]+1,r[i-1][u-1]+s);return r[e][f]}var books={Matthew:28,Mark:16,Luke:24,John:21,Acts:28,Romans:16,"1 Corinthians":16,"2 Corinthians":13,Galatians:6,Ephesians:6,Philippians:4,Colossians:4,"1 Thessalonians":5,"2 Thessalonians":3,"1 Timothy":6,"2 Timothy":4,Titus:3,Philemon:1,Hebrews:13,James:5,"1 Peter":5,"2 Peter":3,"1 John":5,"2 John":1,"3 John":1,Jude:1,Revelation:22},Timer=null,Time=0;$(document).ready(function(){$("#PassageTyper").hide();$("#EndPage").hide();$("#History").hide();$.each(books,function(n){$("#Book").append('<li><a href="#">'+n+"<\/a><\/li>")});$("#Book li > a").click(function(){var t=$(this).text(),i,n;for($("#SelectedBook").text(t),i=books[t],$("#Chapter").html(""),n=0;n<i;n++)$("#Chapter").append('<li><a href="#">'+(n+1)+"<\/a><\/li>"),$("#Chapter li > a").click(function(){var n=$(this).text();$("#SelectedChapter").text(n)})})});$("#Start").click(function(){var n=$("#SelectedBook").text()+$("#SelectedChapter").text();$("#PassageTyper").show();GetPassage(n)});$("#Restart").click(function(){$("#EndPage").hide();Status=2;Score=0;GetVerse();$("#Typed").focus();setTimeout(Timer=setInterval(TimeTick,1e3),1e3)});$("#Submit").click(function(){Status=Status===2?3:2;SubmitVerse();GetVerse();$("#Typed").val("")});$("#Typed").on("keypress",function(n){n.keyCode===13&&$("#Typed").val().length>5&&$("#Submit").click()});