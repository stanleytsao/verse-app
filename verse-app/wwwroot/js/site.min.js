function GetStartEnd(n){$.ajax({url:"https://api.esv.org/v3/passage/html/?q="+n+"&include-verse-anchors=false&include-chapter-numbers=false&include-first-verse-numbers=false&include-footnotes=false&include-headings=false&include-subheadings=false&include-audio-link=false",type:"GET",headers:{Authorization:"Token 00706264fcd4c12e299878dbdf3af0608adbabff"},success:function(n){FirstVerse=n.parsed[0][0];LastVerse=n.parsed[0][1];GetVerse(FirstVerse);$("#TextBox").focus();setTimeout(Timer=setInterval(TimeTick,1e3),500)}})}function GetVerse(n){$.ajax({url:"https://api.esv.org/v3/passage/html/?q="+n+"&include-verse-anchors=false&include-chapter-numbers=false&include-first-verse-numbers=false&include-footnotes=false&include-headings=false&include-subheadings=false&include-audio-link=false",type:"GET",headers:{Authorization:"Token 00706264fcd4c12e299878dbdf3af0608adbabff"},success:function(n){$("#Passage").html(n.passages)}})}function TimeTick(){Time+=1;Time===180?(clearInterval(Timer),$("#FinalScore").text((TotalWords/Time*60).toFixed(1)),$("#EndPage").show(),$("#PassageTyper").hide()):Time%60<10?$("#Time").text("Time: "+Math.floor(Time/60)+":0"+Time%60):$("#Time").text("Time: "+Math.floor(Time/60)+":"+Time%60)}function calculateLevDistance(n,t){var s,e=n.length,f=t.length,h,c,r=[],o,i,u;for(r[0]=[],e<f&&(h=n,n=t,t=h,c=e,e=f,f=c),o=0;o<f+1;o++)r[0][o]=o;for(i=1;i<e+1;i++)for(r[i]=[],r[i][0]=i,u=1;u<f+1;u++)s=n.charAt(i-1)===t.charAt(u-1)?0:1,r[i][u]=Math.min(r[i-1][u]+1,r[i][u-1]+1,r[i-1][u-1]+s);return r[e][f]}var books={Matthew:28,Mark:16,Luke:24,John:21,Acts:28,Romans:16,"1 Corinthians":16,"2 Corinthians":13,Galatians:6,Ephesians:6,Philippians:4,Colossians:4,"1 Thessalonians":5,"2 Thessalonians":3,"1 Timothy":6,"2 Timothy":4,Titus:3,Philemon:1,Hebrews:13,James:5,"1 Peter":5,"2 Peter":3,"1 John":5,"2 John":1,"3 John":1,Jude:1,Revelation:22},Timer=null,Time,SplitTime,TotalWords,FirstVerse,LastVerse;$(document).ready(function(){$("#EndPage").hide();$("#PassageTyper").hide();$("#History").hide();$.each(books,function(n){$("#Book").append('<option value="'+n+'">'+n+"<\/option>")});$("#Book").change(function(){var t=$(this).val(),i=books[t],n;for($("#Chapter").html("<option><\/option>"),n=0;n<i;n++)$("#Chapter").append('<option value="'+(n+1)+'">'+(n+1)+"<\/option>")})});$("#Start").click(function(){if($("#Chapter").val()>0){Time=0;SplitTime=0;TotalWords=0;var n=$("#Book").val()+$("#Chapter").val();GetStartEnd(n);$("#PassageTyper").show()}});$("#Submit").click(function(){var i=$("#TextBox").val().replace(/[^A-Za-z]/gi,"").toLowerCase(),n=$("#Passage").find("p").not("p:last").text().replace(/[^A-Za-z]/gi,"").toLowerCase(),r=calculateLevDistance("",n),u=calculateLevDistance(i,n),f=((1-u/r)*100).toFixed(2),t=$("#TextBox").val().split(" ").length,e=(t/(Time-SplitTime)*60).toFixed(2);$("#History").show();$("#History > tbody").prepend("<tr><td>"+e+"<\/td > <td>"+f+'%<\/td> <td class="mdl-data-table__cell--non-numeric">'+$("#TextBox").val()+"<\/td><\/tr > ");$("#TextBox").val("");TotalWords+=t;$("#WPM").text((TotalWords/Time*60).toFixed(1));FirstVerse<LastVerse?(FirstVerse+=1,GetVerse(FirstVerse),SplitTime=Time):(clearInterval(Timer),$("#FinalScore").text((TotalWords/Time*60).toFixed(1)),$("#EndPage").show(),$("#PassageTyper").hide())});$("#TextBox").on("keypress",function(n){n.keyCode===13&&$("#TextBox").val().length>1&&$("#Submit").click()});